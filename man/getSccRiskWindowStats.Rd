% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SelfControlledCohort.R
\name{getSccRiskWindowStats}
\alias{getSccRiskWindowStats}
\title{Get Self-Controlled Cohort Risk Window Statistics}
\usage{
getSccRiskWindowStats(
  connection,
  outcomeDatabaseSchema,
  tempEmulationSchema = getOption("sqlRenderTempEmulationSchema"),
  oracleTempSchema = NULL,
  outcomeIds = NULL,
  cdmVersion = 5,
  outcomeTable = "condition_era",
  firstOutcomeOnly = TRUE,
  resultsDatabaseSchema = NULL,
  riskWindowsTable = "#risk_windows"
)
}
\arguments{
\item{connection}{DatabaseConnector connection instance}

\item{outcomeDatabaseSchema}{The name of the database schema that is the location where
the data used to define the outcome cohorts is available. If
exposureTable = CONDITION_ERA, exposureDatabaseSchema is not
used by assumed to be cdmSchema.  Requires read permissions
to this database.}

\item{tempEmulationSchema}{Some database platforms like Oracle and Impala do not truly support temp tables. To emulate temp
tables, provide a schema with write privileges where temp tables can be created.}

\item{oracleTempSchema}{For Oracle only: the name of the database schema where you
want all temporary tables to be managed. Requires
create/insert permissions to this database.}

\item{outcomeIds}{The condition_concept_ids or cohort_definition_ids of the
outcomes of interest. If empty, all the outcomes in the
outcome table will be included.}

\item{cdmVersion}{Define the OMOP CDM version used: currently support "4" and
"5".}

\item{outcomeTable}{The tablename that contains the outcome cohorts.  If
outcomeTable <> CONDITION_OCCURRENCE, then expectation is
outcomeTable has format of COHORT table:
COHORT_DEFINITION_ID, SUBJECT_ID, COHORT_START_DATE,
COHORT_END_DATE.}

\item{firstOutcomeOnly}{If TRUE, only use first occurrence of each condition concept
id for each person.}

\item{resultsDatabaseSchema}{Schema to oputput results to. Ignored if resultsTable and
riskWindowsTable are temporary.}

\item{riskWindowsTable}{String: optionally store the risk windows in a (non-temporary)
table.}
}
\value{
list containing data frames:
         treatmentTimeDistribution,
         timeToOutcomeDistribution,
         timeToOutcomeDistributionExposed,
         timeToOutcomeDistributionUnexposed
}
\description{
Compute statistics from risk windows.
}
\details{
Requires a risk window table to be created first with `runSccRiskWindows`
}
\examples{
\dontrun{
# First, create the risk windows table
connectionDetails <- Eunomia::getEunomiaConnectionDetails()
connection <- DatabaseConnector::connect(connectionDetails)
riskWindowsTable <- "computed_risk_windows"
runSccRiskWindows(connection,
                  cdmDatabaseSchema = "main",
                  exposureIds = c(1102527, 1125315),
                  resultsDatabaseSchema = "main", # This is the schema where the results will be stored
                  riskWindowsTable = riskWindowsTable,
                  exposureTable = "drug_era")
# Get stats based on outcomes of interest
tarStats <- getSccRiskWindowStats(connection,
                                  outcomeDatabaseSchema = "main",
                                  resultsDatabaseSchema = "main",
                                  riskWindowsTable = riskWindowsTable,
                                  outcomeTable = "condition_era",
                                  outcomeIds = 192671)
}
}
