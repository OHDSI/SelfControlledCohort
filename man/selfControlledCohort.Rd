% Generated by roxygen2 (4.0.1): do not edit by hand
\name{selfControlledCohort}
\alias{selfControlledCohort}
\title{selfControlledCohort}
\usage{
selfControlledCohort(connectionDetails, cdmSchema, resultsSchema, resultsTablePrefix = "scc", createResultsTable = TRUE, sourceName = "", exposureOutcomePairs, exposureTable = "drug_era", outcomeTable = "condition_era", analysisId = 1, firstOccurrenceDrugOnly = TRUE, firstOccurrenceConditionOnly = TRUE, drugTypeConceptIdList = c(38000182), conditionTypeConceptIdList = c(38000247), genderConceptIdList = c(8507,8532), minAge = "", maxAge = "", minIndex = "", maxIndex = "", stratifyGender = FALSE, stratifyAge = FALSE, stratifyIndex = FALSE, useLengthOfExposureExposed = TRUE, timeAtRiskExposedStart = 1, surveillanceExposed = 30, useLengthOfExposureUnexposed = TRUE, timeAtRiskUnexposedStart = -1, surveillanceUnexposed = -30, hasFullTimeAtRisk = FALSE, washoutPeriodLength = 0, followupPeriodLength = 0, shrinkage = 0.0001)
selfControlledCohort(sccAnalysisDetails, connectionDetails, cdmSchema, resultsSchema, resultsTablePrefix = "scc", createResultsTable = TRUE, sourceName = "", exposureOutcomePairs, exposureTable = "drug_era", outcomeTable = "condition_era")
selfControlledCohort(sccAnalysesDetails, connectionDetails, cdmSchema, resultsSchema, resultsTablePrefix = "scc", createResultsTable = TRUE, sourceName = "", exposureOutcomePairs, exposureTable = "drug_era", outcomeTable = "condition_era")
}
\arguments{
\item{connectionDetails}{An R object of type \code{ConnectionDetails} created using the function \code{createConnectionDetails} in the \code{DatabaseConnector} package.}

\item{cdmSchema}{Name of database schema that contains OMOP CDM and vocabulary.}

\item{resultsSchema}{Name of database schema that we can write results to.}

\item{resultsTablePrefix}{Prefix used for the result tables in the \code{resultsSchema}.}

\item{createResultsTable}{If true, a new empty table will be created to store the results. If false, results will be inserted into the existing table.}

\item{sourceName}{Name of the database, as recorded in results.}

\item{exposureOutcomePairs}{A data frame with at least two columns:
\itemize{
  \item{"exposureConceptId" containing the drug_concept_ID or cohort_concept_id of the exposure variable}
  \item{"outcomeConceptId" containing the condition_concept_ID or cohort_concept_id of the outcome variable}
}}

\item{exposureTable}{\code{exposureTable="drugEra"} or \code{exposureTable="cohort"}.}

\item{outcomeTable}{\code{outcomeTable="cohortconditionEra"} or \code{outcomeTable="cohort"}.}

\item{analysisId}{A unique identifier that can later be used to identify the results of this analysis.}

\item{firstOccurrenceDrugOnly}{If TRUE, only use first occurrence of each drug concept id for each person}

\item{firstOccurrenceConditionOnly}{If TRUE, only use first occurrence of each condition concept id for each person.}

\item{drugTypeConceptIdList}{Which drug_type to use:  generally only use 1 value (ex:  30d era).}

\item{conditionTypeConceptIdList}{Which condition_type to use:  generally only use 1 value (ex:  30d era).}

\item{genderConceptIdList}{List of gender_concept_id, generally use MALE (8507) and FEMALE (8532).}

\item{minAge}{Integer for minimum allowable age.}

\item{maxAge}{Integer for maximum allowable age.}

\item{minIndex}{Date for minimum allowable data for index exposure.}

\item{maxIndex}{Date for maximum allowable data for index exposure.}

\item{stratifyGender}{If TRUE, analysis will be calculated overall, and stratified across all gender groups.}

\item{stratifyAge}{If TRUE, analysis will be calculated overall, and stratified across all age groups  (using AGE_GROUP table below).}

\item{stratifyIndex}{If TRUE, analysis will be calculated overall, and stratified across all years of the index dates.}

\item{useLengthOfExposureExposed}{If TRUE, use the duration from drugEraStart -> drugEraEnd as part of timeAtRisk.}

\item{timeAtRiskExposedStart}{Integer of days to add to drugEraStart for start of timeAtRisk (0 to include index date, 1 to start the day after).}

\item{surveillanceExposed}{Additional window to add to end of exposure period (if useLengthOfExposureExposed = TRUE, then add to exposure end date, else add to exposure start date).}

\item{useLengthOfExposureUnexposed}{if TRUE, use the duration from exposure start -> exposure end as part of timeAtRisk looking back before exposure start.}

\item{timeAtRiskUnexposedStart}{integer of days to add to exposure start for start of timeAtRisk (0 to include index date, -1 to start the day before).}

\item{surveillanceUnexposed}{additional window to add to end of exposure period (if useLengthOfExposureUnexposed = TRUE, then add to exposure end date, else add to exposure start date).}

\item{hasFullTimeAtRisk}{if TRUE, restrict to people who have full time-at-risk exposed and unexposed.}

\item{washoutPeriodLength}{integer to define required time observed before exposure start.}

\item{followupPeriodLength}{integer to define required time observed after exposure start.}

\item{shrinkage}{shrinkage used in IRR calculations, required >0 to deal with 0 case counts, but larger number means more shrinkage.}

\item{sccAnalysisDetails}{object specifyng a set of analysis choices.}

\item{sccAnalysesDetails}{object specifyng one or several sets of analysis choices.}
}
\value{
An object of type \code{sccResults} containing details for connecting to the database containing the results
}
\description{
\code{selfControlledCohort} generates population-level estimation from OMOP CDMv4 instance by comparing exposed and unexposed time among exposed cohort.
}
\details{
Population-level estimation method that estimates incidence rate comparison of exposed/unexposed time within an exposed cohort.
}
\examples{
\dontrun{
  connectionDetails <- createConnectionDetails(dbms="sql server", server="RNDUSRDHIT07.jnj.com")
  exposureOutcomePairs = data.frame(exposureConceptId = c(767410,1314924,907879), outcomeConceptId = c(444382, 79106, 138825))
  sccResult <- selfControlledCohort(connectionDetails, "cdm_truven_mdcr", "scratch", sourceName = "cdm_truven_mdcr", exposureOutcomePairs, outcomeTable = "condition_era")
  plot(sccResult)
}
}
\references{
Ryan PB, Schuemie MJ, Madigan D.Empirical performance of a self-controlled cohort method: lessons for developing a risk
identification and analysis system. Drug Safety 36 Suppl1:S95-106, 2013
}

